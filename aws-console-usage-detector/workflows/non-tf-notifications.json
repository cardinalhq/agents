{
  "objective": "Monitor CloudTrail data to detect AWS resource modifications made by human users outside of Terraform within a time period and send Slack notifications to responsible users",
  "steps": [
    "1. FIND TABLE: Use `get_query_context` to find CloudTrail table in configured datasource. If not found, notify via Slack and exit.",
    "2. VALIDATE DATA EXISTS: Run Report: `cloudtrail-latest-events` to confirm data exists. If 0 events, investigate table structure before proceeding.",
    "3. DETECT CHANGES: Query using Report: `aws-console-drift-detection` as template. Refer to Knowledge: `cloudtrail-terraform-drift-detection-approach` for filtering patterns and Knowledge: `cloudtrail-human-user-identification` for username extraction from principalId.",
    "4. VALIDATE RESULTS: If step 3 returns 0 but step 2 showed data exists, run Report: `cloudtrail-write-events` to verify filters are working.",
    "5. NOTIFY OR EXIT: If changes found, map AWS usernames to Slack users and send DMs reminding them to use Terraform. If no changes after validation, exit without notifications."
  ],
  "guardrails": [
    "Only query tables configured in datasource - never run broad discovery queries against information_schema",
    "Do NOT blindly accept 0 results - always validate data exists first, then verify filters if needed",
    "Use the Reports and Knowledge files for correct query patterns - do not invent your own filtering logic",
    "Only send notifications when human-initiated changes are actually detected and validated"
  ],
  "reports": [
    "aws-console-drift-detection",
    "aws-manual-resource-changes",
    "cloudtrail-latest-events",
    "cloudtrail-write-events"
  ],
  "knowledge": [
    "cloudtrail-human-user-identification",
    "cloudtrail-terraform-drift-detection-approach"
  ],
  "trigger": "schedule",
  "schedule": "0 * * * *"
}