{
  "objective": "Validate a release by comparing telemetry data before and after for a specified service_name and release_time.\n\n",
  "steps": ["Part 1: Define Windows\n\t•\tGet current time (for reference in output).\n\t•\tDefine windows:\n\t•\tPre: [release_time - N, release_time)\n\t•\tPost: [release_time, release_time + N)\nPart 2: Log Analysis\nSeverity\n\t•\tWARN+ if level/status ∈ {warn, warning, error, fatal, critical}\n\t•\tERROR+ if level/status ∈ {error, fatal, critical}\n\t1.\tTotal logs\n\t•\ttotal_pre  = count(logs(service_name, pre))\n\t•\ttotal_post = count(logs(service_name, post))\n\t2.\tWARN+ logs\n\t•\twarn_pre  = count(WARN+ logs in pre)\n\t•\twarn_post = count(WARN+ logs in post)\n\t3.\tWARN+ rate regression (percentage points)\n\t•\tpct_pre  = (warn_pre / total_pre) * 100 (0 if total_pre==0)\n\t•\tpct_post = (warn_post / total_post) * 100 (0 if total_post==0)\n\t•\tdelta_pp = pct_post - pct_pre\n\t•\twarn_regression = (total_pre>0 && total_post>0 && warn_post>=1 && delta_pp >= threshold_pp)\n\t4.\tStopped patterns (any severity)\n\t•\tBuild pattern counts for all logs in pre/post using the same patterning logic.\n\t•\tFlag Stopped Pattern when: pre_count(pattern) >= min_pattern_count AND post_count(pattern) == 0.\n\t5.\tNew error patterns (true errors only)\n\t•\tBuild pattern counts using ERROR+ logs only.\n\t•\tFlag New Error Pattern when: pre_err_count(pattern) == 0 AND post_err_count(pattern) >= min_pattern_count.\nPart 3: Metrics Analysis\n\t1.\tCompare system metrics (CPU, Memory, Network, Disk) pre vs post.\n\t2.\tCheck error metrics for sustained increases post-release.\n\t3.\tCheck latency metrics (P50/P99) for sustained increases post-release.\n\t4.\tFor custom metrics: identify critical tags, group by them, compare pre vs post.\nPart 4: Send Results to Slack ONLY when Part 2 and 3 are complete. \n\t•\tSend the final results exactly once to #general on Slack (no partial/progress messages)."],
  "guardrails": ["\t•\tDo not send Slack until all analysis is complete:\n\t•\ttotal_pre/total_post, warn_pre/warn_post, pct_pre/pct_post/delta_pp/warn_regression\n\t•\tstopped patterns computed (or empty)\n\t•\tnew ERROR+ patterns computed (or empty)\n\t•\tmetric comparisons + metric flags computed (or none)\n\t•\tall Blockit grids fully constructed\n\t•\tSend exactly one Slack message. Never send follow-ups.\nLog Analysis Thresholds\n\t•\tFlag WARN+ Regression if warn_regression == true (uses threshold_pp, default 20 pp).\n\t•\tFlag Stopped Pattern if pre_count >= min_pattern_count and post_count == 0.\n\t•\tFlag New Error Pattern only from ERROR+ logs where pre_err_count == 0 and post_err_count >= min_pattern_count.\nMetrics Analysis Thresholds\n\t•\tFlag latency if P50 or P99 post-release is ≥ 1.5x pre-release.\n\t•\tDirectionality is contextual:\n\t•\tErrors/latency up = bad\n\t•\tRequests down = bad\nOutput Format Instructions (Slack)\n\t•\tPost exactly one Slack message to Ruchir.\n\t•\tMessage contains only Blockit grids (no prose, bullets, or extra commentary).\n\t•\tAlways include Verdict Grid.\n\t•\tInclude Log Issues Grid only if any log guardrail flagged.\n\t•\tInclude Metric Issues Grid only if any metric guardrail flagged.\n\t•\tIf no issues for a section, omit that grid.\nGrid 1: Verdict (ALWAYS)\nColumns (exact):\n\t•\tVerdict (\uD83D\uDC4D or \uD83D\uDC4E)\n\t•\tService\n\t•\tRelease Time\n\t•\tWindow\n\t•\tWARN+ % Pre\n\t•\tWARN+ % Post\n\t•\tDelta (pp)\n\t•\tThreshold (pp)\n\t•\tWARN+ Regression (PASS/FAIL)\nRules:\n\t•\tPercent values rounded to 2 decimals.\n\t•\tDelta (pp) = WARN+ % Post - WARN+ % Pre (2 decimals).\n\t•\tWARN+ Regression = FAIL iff warn_regression == true, else PASS.\nGrid 2: Log Issues (ONLY if any log guardrail flagged)\nColumns (exact):\n\t•\tIssue\n\t•\tPattern\n\t•\tExample\n\t•\tPre Count\n\t•\tPost Count\n\t•\tWhy it matters\nRules:\n\t•\tIssue ∈ {WARN+ Regression, Stopped Pattern, New Error Pattern}\n\t•\tNew Error Pattern rows must come from ERROR+ logs only.\n\t•\tExample max 140 chars.\nGrid 3: Metric Issues (ONLY if any metric guardrail flagged)\nColumns (exact):\n\t•\tMetric\n\t•\tScope (Overall or tag breakdown label)\n\t•\tPre\n\t•\tPost\n\t•\tChange\n\t•\tThreshold\n\t•\tWhy it matters\nRules:\n\t•\tChange formatted as +X%/-X% (1 decimal) or x1.5 for ratios.\n\t•\tThreshold must match the rule that triggered.\n\t•\tInclude only metrics that triggered a guardrail.\nOrdering\n\t•\tVerdict grid first.\n\t•\tLog Issues grid second (if present): WARN+ Regression → New Error Pattern → Stopped Pattern.\n\t•\tMetric Issues grid last (if present): errors → latency → requests → system.\nHard constraint\n\t•\tNo non-Blockit text in Slack."],
  "reports": [
    "service-logs-search",
    "service-logs-retrieval",
    "service-request-count",
    "service-request-count-by-dimension",
    "service-error-count",
    "service-error-count-by-dimension",
    "service-error-rate",
    "service-latency-percentiles",
    "http-request-duration-average",
    "http-duration-by-status",
    "average-http-request-duration",
    "server-request-count",
    "client-requests-by-server"
  ],
  "knowledge": [],
  "trigger": "schedule",
  "schedule": "0 0 * * *"
}
