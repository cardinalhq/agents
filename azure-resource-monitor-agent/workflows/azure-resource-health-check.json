{
  "name": "azure-resource-health-check",
  "description": "Comprehensive Azure resource monitoring and health assessment workflow",
  "schedule": {
    "cron": "0 */6 * * *",
    "timezone": "UTC"
  },
  "steps": [
    {
      "name": "fetch_resource_metrics",
      "type": "data_query",
      "datasource": "azure_monitor",
      "query": "Get performance metrics for all monitored resources"
    },
    {
      "name": "analyze_vm_utilization",
      "type": "data_query",
      "datasource": "azure_monitor",
      "query": "Get VM CPU, memory, and disk utilization"
    },
    {
      "name": "fetch_cost_data",
      "type": "data_query",
      "datasource": "azure_cost_management",
      "query": "Get cost breakdown by resource for the last 7 days"
    },
    {
      "name": "assess_resource_health",
      "type": "analysis",
      "input": ["fetch_resource_metrics", "analyze_vm_utilization"],
      "criteria": {
        "cpu_threshold": 85,
        "memory_threshold": 80,
        "disk_threshold": 90,
        "health_check_window": "1h"
      }
    },
    {
      "name": "identify_optimization_opportunities",
      "type": "analysis",
      "input": ["analyze_vm_utilization", "fetch_cost_data"],
      "criteria": {
        "underutilization_threshold": 15,
        "minimum_cost_threshold": 20
      }
    },
    {
      "name": "generate_health_report",
      "type": "report_generation",
      "template": "resource_health_summary",
      "input": ["assess_resource_health", "identify_optimization_opportunities"]
    },
    {
      "name": "send_teams_notification",
      "type": "notification",
      "datasource": "teams",
      "input": ["generate_health_report"]
    }
  ]
}